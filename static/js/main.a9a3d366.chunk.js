(this["webpackJsonporder-book"]=this["webpackJsonporder-book"]||[]).push([[0],{12:function(e,t,o){e.exports={colors:"'../colors.module.css'","dark-gray":"#23272a","ghost-white":"#F7F7FF",button:"components_button__2Zb4I",icon:"components_icon__30S-9"}},19:function(e,t,o){e.exports={colors:'"./colors.module.css"',"mid-gray":"#2c2f33","ghost-white":"#F7F7FF","dark-gray":"#23272a",app:"App_app__1kX79",header:"App_header__3ZZ1n"}},2:function(e,t,o){e.exports={colors:'"../../colors.module.css"',"dark-green-fifty":"#00640050","red-fifty":"#D32E0550","dark-green":"#006400",red:"#D32E05","dark-gray":"#23272a","mid-gray":"#2c2f33",blurple:"#7289dA","ghost-white":"#F7F7FF","row-font-size":"18px","row-line-height":"1.5em","row-bottom-margin":"5px",container:"OrderBook_container__3gBKY",actions:"OrderBook_actions__1Meu6",action:"OrderBook_action__12sXR",orderHeader:"OrderBook_orderHeader__lwfEy",orders:"OrderBook_orders__2fvpA",header:"OrderBook_header__1YYRx",orderBookCol:"OrderBook_orderBookCol__l8Mbd",loading:"OrderBook_loading__VggxG",rows:"OrderBook_rows__3DS8V",bidRow:"OrderBook_bidRow__3ci1w",askRow:"OrderBook_askRow__2iGhH",bidPrice:"OrderBook_bidPrice__2itJa",askPrice:"OrderBook_askPrice__21P0k",headerTitle:"OrderBook_headerTitle__1lHeT",val:"OrderBook_val__3C_F9",killBtn:"OrderBook_killBtn__1qENh components_button__2Zb4I",toggleBtn:"OrderBook_toggleBtn__2H4Ef components_button__2Zb4I",loader:"OrderBook_loader__3cVi2",disconnectedText:"OrderBook_disconnectedText__3sDaw",groupDropdown:"OrderBook_groupDropdown__1XT4o"}},32:function(e,t,o){},49:function(e,t,o){"use strict";o.r(t);var n=o(0),c=o.n(n),r=o(8),a=o.n(r),i=(o(32),o(19)),s=o.n(i),d=o(7),l=o(5),u=o(3),b=o(23),j=o(4),h=function(e,t){return e.orderBook.books[t.bookId]},O=function(e){return e.orderBook.activeBookId},k=function(e){return e.orderBook.activeBookState},v=function(e,t){return function(o,n){var c=+n-+n%t;if(o.length>0&&o[o.length-1].price===c)return o[o.length-1].size+=e[+n],o[o.length-1].total+=e[+n],o;var r=0===o.length?0:o[o.length-1].total;return o.push({price:c,size:e[+n],total:r+e[+n]}),o}},p=Object(j.a)([O,function(e){return e.orderBook.books}],(function(e,t){return e in t?t[e]:null})),f=Object(j.a)([h],(function(e){if(!e)return[];var t=e.grouping,o=e.asks;return Object.keys(o).sort().reduce(v(o,t.value),[])})),g=Object(j.a)([h],(function(e){if(!e)return[];var t=e.bids,o=e.grouping;return Object.keys(t).sort().reverse().reduce(v(t,o.value),[])})),_=(Object(j.a)([h],(function(e){if(!e)return 0;var t=Object.values(e.asks).reduce((function(e,t){return e+t}),0),o=Object.values(e.bids).reduce((function(e,t){return e+t}),0);return Math.max(t,o)})),Object(j.a)([f,g],(function(e,t){var o=e.length>0?e[0].price:0,n=t.length>0?t[0].price:0;return Math.abs(o-n)})),Object(j.a)([p],(function(e){return e?e.grouping:null}))),x=o(2),B=o.n(x),m=function(){return Object(u.b)()},y=(u.c,o(1)),w={PI_XBTUSD:[{value:.5,label:"Group 0.5"},{value:1,label:"Group 1.0"},{value:2.5,label:"Group 2.5"}],PI_ETHUSD:[{value:.05,label:"Group 0.05"},{value:.1,label:"Group 0.1"},{value:.25,label:"Group 0.25"}]},I={option:function(e){return Object(l.a)(Object(l.a)({},e),{},{width:150,borderBottom:"0",color:B.a["ghost-white"],backgroundColor:B.a["mid-gray"],padding:20,cursor:"pointer","&:hover":{opacity:.8}})},control:function(){return{width:150,color:B.a["ghost-white"],backgroundColor:B.a["mid-gray"],display:"flex",cursor:"pointer"}},singleValue:function(e,t){var o=t.isDisabled?.5:1;return Object(l.a)(Object(l.a)({},e),{},{opacity:o,transition:"opacity 300ms",color:B.a["ghost-white"],backgroundColor:B.a["mid-gray"],fontSize:16})},menuList:function(){return{padding:0}}};function S(){var e=m(),t=Object(u.c)(O),o=Object(u.c)(_),c=Object(n.useCallback)((function(t){e(Z(t))}),[e]);return Object(y.jsx)(b.a,{value:o||w[t][1],styles:I,defaultValue:w[t][1],name:"group",options:w[t],onChange:c})}var C=c.a.memo(S),N="orderBooks/SUBSCRIBE_ORDERBOOK",E="orderBooks/KILL_ACTIVE_BOOK",T="orderBooks/RECONNECT_ACTIVE_BOOK",D=Object(d.b)(N),V=Object(d.b)(E),z=Object(d.b)(T);function F(e,t,o,n){for(var c in o){var r=+o[c][0],a=+o[c][1],i="bids"===n?e.books[t].bids:e.books[t].asks;0!==a?i[r]=a:r in i&&delete i[r]}}var M=Object(d.c)({name:"orderBooks",initialState:{books:{},activeBookId:"PI_XBTUSD",activeBookState:"disconnected"},reducers:{updateBook:function(e,t){var o=t.payload,n=o.bookId,c=o.bids,r=o.asks;F(e,n,c,"bids"),F(e,n,r,"asks")},updateActiveBook:function(e,t){e.activeBookId=t.payload},activeBookConnected:function(e){e.books[e.activeBookId]={grouping:w[e.activeBookId][1],bids:{},asks:{}},e.activeBookState="connected"},activeBookConnecting:function(e){e.activeBookState="connecting"},bookDisconnected:function(e,t){t.payload===e.activeBookId&&(e.activeBookState="disconnected"),delete e.books[t.payload]},updateGrouping:function(e,t){e.books[e.activeBookId].grouping=t.payload}},extraReducers:function(e){e.addCase(D,(function(e){return e.activeBookState="connecting",e})),e.addCase(V,(function(e){return e.activeBookState="disconnected",e}))}}),R=M.actions,P=R.activeBookConnected,A=R.activeBookConnecting,G=R.bookDisconnected,L=R.updateActiveBook,H=R.updateBook,Z=R.updateGrouping,J=M.reducer,K=o(15),U=o(11),X=o.n(U);function Y(e){var t=e.maxSize,o=e.orderLevel,n=e.type,c=e.isVerticallyOriented,r=Object(K.a)(e,["maxSize","orderLevel","type","isVerticallyOriented"]),a=o.price,i=o.size,s=o.total,d="bid"===n?B.a.bidRow:B.a.askRow,u=s/t*100,b="bid"===n?B.a.bidPrice:B.a.askPrice,j=!c&&"bid"===n,h=[Object(y.jsx)("div",{className:X()(B.a.val,b),children:a.toFixed(2)},"price"),Object(y.jsx)("div",{className:B.a.val,children:i},"size"),Object(y.jsx)("div",{className:B.a.val,children:s},"total")];return Object(y.jsx)("div",Object(l.a)(Object(l.a)({className:d,style:{backgroundSize:"".concat(u,"% 100%")}},r),{},{children:j?h.reverse().map((function(e){return e})):h.map((function(e){return e}))}))}var W=c.a.memo(Y);function q(e){var t=e.type,o=!e.isVerticallyOriented&&"bid"===t?["TOTAL","SIZE","PRICE"]:["PRICE","SIZE","TOTAL"];return Object(y.jsx)("div",{className:B.a.header,children:o.map((function(e){return Object(y.jsx)("div",{className:B.a.headerTitle,children:e},e)}))})}var Q=c.a.memo(q);function $(e){var t=e.isVerticallyOriented,o=e.loading,n=e.type,c=e.orders,r=e.maxSize,a=o?B.a.loading:"";return Object(y.jsxs)("div",{className:X()(B.a.orderBookCol,a),children:[Object(y.jsx)(Q,{type:n,isVerticallyOriented:t}),Object(y.jsx)("div",{className:B.a.rows,children:c.map((function(e){return Object(y.jsx)(W,{orderLevel:e,maxSize:r,type:n,isVerticallyOriented:t},e.price)}))})]})}var ee=o(51),te=o(12),oe=o.n(te);function ne(e){var t=e.className,o=void 0===t?oe.a.button:t,n=Object(K.a)(e,["className"]);return Object(y.jsx)("button",Object(l.a)(Object(l.a)({className:o},n),{},{children:n.children}))}function ce(e){var t=e.width,o=void 0===t?16:t,n=e.height,c=void 0===n?16:n;return Object(y.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:o,height:c,viewBox:"0 0 478.125 478.125",className:oe.a.icon,children:Object(y.jsx)("g",{children:Object(y.jsx)("g",{children:Object(y.jsxs)("g",{children:[Object(y.jsx)("circle",{cx:"239.904",cy:"314.721",r:"35.878"}),Object(y.jsx)("path",{d:"M256.657,127.525h-31.9c-10.557,0-19.125,8.645-19.125,19.125v101.975c0,10.48,8.645,19.125,19.125,19.125h31.9 c10.48,0,19.125-8.645,19.125-19.125V146.65C275.782,136.17,267.138,127.525,256.657,127.525z"}),Object(y.jsx)("path",{d:"M239.062,0C106.947,0,0,106.947,0,239.062s106.947,239.062,239.062,239.062c132.115,0,239.062-106.947,239.062-239.062 S371.178,0,239.062,0z M239.292,409.734c-94.171,0-170.595-76.348-170.595-170.596c0-94.248,76.347-170.595,170.595-170.595 s170.595,76.347,170.595,170.595C409.887,333.387,333.464,409.734,239.292,409.734z"})]})})})})}function re(){var e=m(),t="disconnected"===Object(u.c)((function(e){return e.orderBook.activeBookState})),o=Object(n.useCallback)((function(){e(t?z():V())}),[e,t]),c=t?"Reconnect":"Kill Feed";return Object(y.jsxs)(ne,{className:B.a.killBtn,onClick:o,children:[Object(y.jsx)(ce,{}),Object(y.jsx)("span",{children:c})]})}function ae(e){var t=e.width,o=void 0===t?16:t,n=e.height,c=void 0===n?16:n;return Object(y.jsx)("svg",{className:oe.a.icon,xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 32 32",width:o,height:c,children:Object(y.jsx)("g",{children:Object(y.jsx)("g",{id:"transfer",children:Object(y.jsxs)("g",{children:[Object(y.jsx)("polygon",{points:"32,24 7.992,24 7.992,28 0,22 7.992,16 7.992,20 32,20"}),Object(y.jsx)("polygon",{points:"0,12 24,12 24,16 32,10 24,4 24,8 0,8"})]})})})})}var ie=["PI_XBTUSD","PI_ETHUSD"];function se(){var e=m(),t=Object(u.c)(O),o=Object(n.useCallback)((function(){e(L(t===ie[0]?ie[1]:ie[0]))}),[e,t]);return Object(y.jsxs)(ne,{className:B.a.toggleBtn,onClick:o,children:[Object(y.jsx)(ae,{}),"Toggle feed"]})}var de=o(22),le=o.n(de);function ue(){return Object(y.jsx)("div",{className:B.a.loader,children:Object(y.jsx)(le.a,{type:"bars",color:"white"})})}function be(e){var t=e.isVerticallyOriented,o=Object(n.useRef)(null),c=parseInt(B.a["row-font-size"]),r=parseFloat(B.a["row-line-height"]),a=parseInt(B.a["row-bottom-margin"]),i=o&&o.current?Math.floor(o.current.offsetHeight/(c*r+a))-1:0,s=Object(u.c)(k),d="connecting"===s,l="disconnected"===s;t&&(i=Math.floor(i/2));var b=Object(u.c)((function(t){return g(t,e)})).slice(0,i),j=Object(u.c)((function(t){return f(t,e)})).slice(0,i),h=b.length>0?b[b.length-1].total:0,O=j.length>0?j[j.length-1].total:0,v=Math.max(h,O),p=Object(ee.a)(b,250),_=Object(ee.a)(j,250),x=Object(ee.a)(v,250);return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)("div",{className:B.a.container,children:[Object(y.jsxs)("div",{className:B.a.orderHeader,children:[Object(y.jsx)("span",{children:"Order Book"}),l?Object(y.jsx)("span",{className:B.a.disconnectedText,children:"Disconnected"}):null,Object(y.jsx)(C,{})]}),Object(y.jsxs)("div",{className:B.a.orders,ref:o,children:[d?Object(y.jsx)(ue,{}):null,Object(y.jsx)($,{loading:d,orders:p,maxSize:x,isVerticallyOriented:t,type:"bid"}),Object(y.jsx)($,{loading:d,orders:_,maxSize:x,type:"ask",isVerticallyOriented:t})]})]}),Object(y.jsxs)("div",{className:B.a.actions,children:[Object(y.jsx)(se,{}),Object(y.jsx)(re,{})]})]})}var je=o(24);var he=function(){var e=m(),t=Object(u.c)(O),o=Object(je.a)()<=1024,c=o?"vertical":"";return Object(n.useEffect)((function(){e(D(t))}),[e,t]),Object(y.jsxs)("div",{className:X()(s.a.app,c),children:[Object(y.jsx)("header",{className:s.a.header,children:t}),Object(y.jsx)(be,{bookId:t,isVerticallyOriented:o})]})},Oe=o(13),ke=o(14),ve=o(26),pe=o(9),fe=o(27),ge=o(25),_e=function(e){Object(fe.a)(o,e);var t=Object(ge.a)(o);function o(e,n){var c;return Object(Oe.a)(this,o),(c=t.call(this,e,"wss://www.cryptofacilities.com/ws/v1")).productId=void 0,c.dispatch=void 0,c.productId=e,c.dispatch=n,c}return Object(ke.a)(o,[{key:"subscribe",value:function(e){this.productId=e,this.sendMessage(JSON.stringify({event:"subscribe",feed:"book_ui_1",product_ids:[this.productId]}))}},{key:"unsubscribe",value:function(){this.sendMessage(JSON.stringify({event:"unsubscribe",feed:"book_ui_1",product_ids:[this.productId]}))}},{key:"handleMessage",value:function(e){try{var t=JSON.parse(e.data);this.dispatch(H({bookId:t.product_id,bids:t.bids,asks:t.asks}))}catch(o){}}},{key:"handleConnected",value:function(){this.subscribe(this.productId),this.dispatch(P())}},{key:"handleDisconnect",value:function(){this.dispatch(G(this.productId))}},{key:"disconnect",value:function(){this.unsubscribe(),Object(ve.a)(Object(pe.a)(o.prototype),"disconnect",this).call(this)}}]),o}(function(){function e(t,o){var n=this;Object(Oe.a)(this,e),this.id=void 0,this.socket=void 0,this.id=t,this.socket=new WebSocket(o),this.socket.onopen=function(){n.addEventListeners(),n.handleConnected()}}return Object(ke.a)(e,[{key:"addEventListeners",value:function(){var e=this;this.socket.onmessage=function(t){e.handleMessage(t)},this.socket.onclose=function(){e.handleDisconnect()}}},{key:"sendMessage",value:function(e){this.socket.readyState===WebSocket.OPEN&&this.socket.send(e)}},{key:"disconnect",value:function(){this.socket.close()}},{key:"handleMessage",value:function(e){}},{key:"handleConnected",value:function(){}},{key:"handleDisconnect",value:function(){}}]),e}()),xe={},Be=o(6),me=Object(Be.b)({orderBook:J}),ye=Object(d.a)({reducer:me,middleware:[function(e){return function(t){return function(o){var n=e.getState().orderBook.activeBookId,c=o;switch(o.type){case L.type:n in xe&&(xe[n].disconnect(),delete xe[n]);break;case N:n in xe&&(xe[n].disconnect(),delete xe[n]);var r=new _e(o.payload,e.dispatch);xe[o.payload]=r,c=A();break;case E:n in xe&&(xe[n].socket.close(),delete xe[n]);break;case T:var a=new _e(n,e.dispatch);xe[n]=a,c=A()}return t(c)}}}]});a.a.render(Object(y.jsx)(c.a.StrictMode,{children:Object(y.jsx)(u.a,{store:ye,children:Object(y.jsx)(he,{})})}),document.getElementById("root"))}},[[49,1,2]]]);
//# sourceMappingURL=main.a9a3d366.chunk.js.map